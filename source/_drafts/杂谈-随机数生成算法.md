---
title: '[杂谈]随机数生成算法'
tags:
  - 计算机科学
categories:
  - 杂谈
---


## 常见的随机数生成算法

### 线性同余方法

线性同余方法（Linear Congruential Generator，LCG）是最简单的产生随机数的方法。

**1. 基本原理**

LCG 的核心思想是：通过一个简单的线性变换和取模运算，将当前状态转换为下一个"随机"数。

递推公式：

$$
N_{n+1} = (A × N_n + B) \mod M
$$

其中：
- $A$：乘数（multiplier）
- $B$：增量（increment）
- $M$：模数（modulus）
- $N_0$：种子（seed），即初始值

**2. 公式含义**

这个公式实际上在做两件事：
1. **线性变换**：$A × N_n + B$ 将当前数进行线性变换
2. **取模运算**：$\mod M$ 将结果限制在 $[0, M-1]$ 范围内。

由于取模，序列最终会重复，形成周期。

**一个简单例子**

假设 $A = 3$，$B = 1$，$M = 7$，$N_0 = 2$：

- $N_1 = (3 × 2 + 1) \mod 7 = 7 \mod 7 = 0$
- $N_2 = (3 × 0 + 1) \mod 7 = 1 \mod 7 = 1$
- $N_3 = (3 × 1 + 1) \mod 7 = 4 \mod 7 = 4$
- $N_4 = (3 × 4 + 1) \mod 7 = 13 \mod 7 = 6$
- $N_5 = (3 × 6 + 1) \mod 7 = 19 \mod 7 = 5$
- $N_6 = (3 × 5 + 1) \mod 7 = 16 \mod 7 = 2$（回到初始值）

可以看到，序列为：2 → 0 → 1 → 4 → 6 → 5 → 2...，周期为 6。

**3. 最大周期条件**

LCG 的最大周期是 $M$，但要达到最大周期，需要满足以下条件（Hull-Dobell 定理）：

1. **$B$ 与 $M$ 互质**：确保增量不会与模数有公因子，避免某些值永远无法生成
2. **$M$ 的所有质因数都能整除 $A - 1$**：保证乘数 $A$ 与模数 $M$ 的质因数结构匹配
3. **若 $M$ 是 4 的倍数，$A - 1$ 也是**：处理模数为偶数时的特殊情况
4. **$A$, $B$, $N_0$ 小于 $M$**：这是取模运算的自然要求
5. **$A$，$B$ 是正整数**：保证计算的正确性

**为什么需要这些约束？**

这些约束条件看似复杂，实际上是为了**避免序列过早重复**。如果不满足这些条件，序列可能会：
- 周期很短（比如只有几个数就重复）
- 某些数字永远不会出现
- 有明显的规律性，不够"随机"

**4. 实际应用**

历史上一些著名的 LCG 实现：
- **ANSI C 的 `rand()`**：$A = 1103515245$，$B = 12345$，$M = 2^{31}$
- **Java 的 `java.util.Random`**：$A = 25214903917$，$B = 11$，$M = 2^{48}$

**5. 优缺点**

**优点**：
- 实现简单，计算快速
- 内存占用小（只需保存当前状态）
- 可重现（相同种子产生相同序列）

**缺点**：
- 随机性质量较差，有明显的统计缺陷
- 序列存在相关性，不适合密码学应用
- 低维空间中分布不均匀（如二维平面上会形成可见的网格模式）

现代应用中，LCG 主要用于教学和简单场景，更高质量的随机数生成通常使用梅森旋转算法（Mersenne Twister）等更先进的算法。

### 梅森旋转
